# load plugins
nop %sh{
    mkdir -p "$kak_config/autoload"
    ln -s "$kak_runtime/autoload" "$kak_config/autoload/standard-library"
}

# indentation
set-option global tabstop 8
set-option global indentwidth 0

# aesthetics
set-face global comment bright-black,default+i
set-face global Whitespace bright-black,default+i
set-face global LineNumbers bright-black,default+i
set-face global WrapMarker bright-black,default

add-highlighter global/ number-lines
add-highlighter global/ show-matching
add-highlighter global/ wrap -marker '↪\'

define-command expandtab %{
	map window insert <tab> '<a-;><a-gt>'
	map window insert <s-tab> '<a-;><a-lt>'
	set-option window indentwidth %opt{tabstop}
}

define-command noexpandtab %{
	unmap window insert <tab> '<a-;><a-gt>'
	unmap window insert <s-tab> '<a-;><a-lt>'
	set-option window indentwidth 0
}

# file-specific options
# TODO: Add proper indentation styles for each filetype I use
hook global WinSetOption filetype=c %{
	set-option window lintcmd "cppcheck --language=c --std=c99 --enable=all --template='{file}:{line}:{column}: {severity}: {message}' 2>&1"
	set-option window tabstop 8
	noexpandtab
}

hook global WinSetOption filetype=cpp %{
	set-option window lintcmd "cppcheck --language=c++ --std=c++11 --enable=all --template='{file}:{line}:{column}: {severity}: {message}' 2>&1"
	set-option window tabstop 8
	noexpandtab
}

hook global WinSetOption filetype=html %{
	set-option window tabstop 2
	expandtab
}

hook global WinSetOption filetype=css %{
	set-option window tabstop 2
	expandtab
}

hook global WinSetOption filetype=js %{
	set-option window tabstop 2
	expandtab
}

hook global WinSetOption filetype=latex %{
	add-highlighter buffer/ wrap -word -marker '↪\'
	set-option window tabstop 4
	noexpandtab
}

hook global WinSetOption filetype=markdown %{
	set-option window lintcmd "proselint"
	add-highlighter buffer/ wrap -word -marker '↪\'
	set-option window tabstop 4
	expandtab
}

hook global WinSetOption filetype=python %{
	set-option window tabstop 4
	expandtab
}

hook global WinSetOption filetype=sh %{
	set-option window lintcmd "shellcheck -fgcc -Cnever"
	set-option window tabstop 8
	noexpandtab
}
